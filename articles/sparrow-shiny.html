<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interactive Exploration SparrowResults with sparrow.shiny • sparrow.shiny</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Interactive Exploration SparrowResults with sparrow.shiny">
<meta property="og:description" content="sparrow.shiny">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sparrow.shiny</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/sparrow-shiny.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="sparrow-shiny_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Interactive Exploration SparrowResults with sparrow.shiny</h1>
                        <h4 class="author">Steve Lianoglou</h4>
            
            <h4 class="date">22 November 2021</h4>
      
      
      <div class="hidden name"><code>sparrow-shiny.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>This package provides a number of shiny modules we can use to interact with a <code>SparrowResult</code> object we get from invoking <code><a href="https://rdrr.io/pkg/sparrow/man/seas.html">sparrow::seas()</a></code>.</p>
<p>We also provide a shiny app that combines these modules together for interactive exploration which can be launched via the <code><a href="../reference/explore.html">explore()</a></code> method. We’ll go over the functionality of the app here.</p>
</div>
<div id="setup" class="section level2">
<h2 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h2>
<p>We’ll perform a GSEA analysis using the <code><a href="https://rdrr.io/pkg/limma/man/camera.html">limma::cameraPR()</a></code> and an overrepresentaiton analysis (goseq-like test) via <code><a href="https://rdrr.io/pkg/sparrow/man/ora.html">sparrow::ora</a></code> using an example expression dataset from the sparrow package, which was taken from a subset of samples from the TCGA/BRCA indication.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lianos/sparrow">sparrow</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">sparrow.shiny</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="va">vm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sparrow/man/examples.html">exampleExpressionSet</a></span><span class="op">(</span>do.voom <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>We’ll also use a subset of the C2, C6, and C7 MSigDB gene set collections, which is also available as an example dataset in the sparrow package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sparrow/man/examples.html">exampleGeneSetDb</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><code>gdb</code> contains the following number of genesets per collection:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/sparrow/man/geneSets.html">geneSets</a></span><span class="op">(</span><span class="va">gdb</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">collection</span><span class="op">)</span></code></pre></div>
<pre><code>##   collection  n
## 1         c2 30
## 2         c6 26
## 3         c7 20</code></pre>
<p>And finally, we’ll run the <code>limm::cameraPR()</code> and <code><a href="https://rdrr.io/pkg/sparrow/man/ora.html">sparrow::ora()</a></code> enrichment tests on the tumor vs normal comparion:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sparrow/man/seas.html">seas</a></span><span class="op">(</span><span class="va">vm</span>, <span class="va">gdb</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cameraPR"</span>, <span class="st">"ora"</span><span class="op">)</span>, <span class="va">vm</span><span class="op">$</span><span class="va">design</span>, <span class="st">"tumor"</span><span class="op">)</span></code></pre></div>
<p>You can launch the shiny app included here to explore the <code>seas</code> results via the <code><a href="../reference/explore.html">sparrow.shiny::explore()</a></code> function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/explore.html">explore</a></span><span class="op">(</span><span class="va">sres</span><span class="op">)</span></code></pre></div>
<p>When you do that, you will be greeted with a tabbed interface with the following tabs outlined below.</p>
</div>
<div id="overview-1" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-1" class="anchor"></a>Overview</h2>
<p><img src="images/explore-landing-page.png" alt="shiny landing and overview page"> The control widgets in the top right box, outlined in purple, allow the user to filter which geneset results to view by only showing those genesets that have an FDR cutoff of less than 20% under the cameraPR analysis.</p>
<p>The table at the bottom that is highlighted with red and blue boxes gives you an overview of your GSEA hits from at the 20% cutoff. The numbers in the red box recapitulate the same output we calculated above, which tells us the number of genesets <em>per collection</em> we ran our analysis against (30 c2 gene sets, 26 c6, and 20 c7). The blue-highlighted portion of the table tells us the number of genesets per collection that satisfy the 20% FDR cutoff for each of the GSEA methods we ran: cameraPR or ora.</p>
<p>We can see that at an FDR of 20%, 19 gene sets in the c2 collection were significant, and nine of those gene sets are going up, whiel ten are going down.</p>
<p>Although we only ran one “ora” (over representation analysis), it is by default run in three ways:</p>
<ol style="list-style-type: decimal">
<li>
<code>ora</code>: pathway enrichment results from taking all up and down DGE genes.</li>
<li>
<code>ora.up</code>: pathway enrichment analysis using only up regulated genes.</li>
<li>
<code>ora.down</code>: pathway enrichment analysis using only down regulated genes.</li>
</ol>
</div>
<div id="gsea-results" class="section level2">
<h2 class="hasAnchor">
<a href="#gsea-results" class="anchor"></a>GSEA Results</h2>
<p><img src="images/browse-results.png" alt="GSEA results tab"> The genesets that are signifcant via a cameraPR analysis at an FDR cutoff less than 20% are listed on the table on the right. Clicking on the different rows of the table will select it for view, updating the <code>geneSetContrastView</code> module on the left.</p>
<div id="the-genesetcontrastview-module" class="section level3">
<h3 class="hasAnchor">
<a href="#the-genesetcontrastview-module" class="anchor"></a>The geneSetContrastView Module</h3>
<p>Provides a graphical view of the result, a tabular view which lists all of the genes in the geneset as well as their individual differential expression statistics, and the ability to select genes in the geneset to see <em>what other</em> gene sets they are also a part of.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Steve Lianoglou, Denali Therapeutics, Genentech.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
